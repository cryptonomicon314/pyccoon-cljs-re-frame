<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>re-frame 0.4.1: examples/todomvc/src/todomvc/views.cljs</title>
  <link rel="stylesheet" href="../../../../pyccoon.css">
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']], processEscapes: true}
  });
  </script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div id='container' >
  <div id="footer">
    <span id="project-name">
        <a class="btn" href="../../../../index.html">re-frame 0.4.1</a>
    </span>
    <a class="btn" class="source source-1" href="#top">Back to top</a>
    <div class="generation-time">
        Generated at
        <code>2015-07-06 20:04</code>
        by a diligent
        <a target="_blank" href="http://ckald.github.io/pyccoon/" title="Pyccoon: side-to-side documentation generator">
            <img id="pyccoon-icon" src="../../../../pyccoon_icon.svg" alt="Pyccoon: side-to-side documentation generator" />pyccoon</a>
    </div>
  </div>
  <a id="top"></a>
  <div class='section'>
    <div class='docs nav'>
      <nav id="breadcrumbs">/ <a href="views.cljs.html/../../../../../index.html">.</a> / <a href="views.cljs.html/../../../../index.html">examples</a> / <a href="views.cljs.html/../../../index.html">todomvc</a> / <a href="views.cljs.html/../../index.html">src</a> / <a href="views.cljs.html/../index.html">todomvc</a> / views.cljs</nav>
      <ul id="children"></ul>
    </div>
  </div>
  <div id="everything" class='clearall'>
    <div id="background"></div>
    <div class='section'>
    <a id="section-0" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-0'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <a id="_todomvc.views" class="section-anchor"></a><div class="highlight"><pre><span class="p">(</span><span class="kd">ns </span><span class="nv"><a class="hidden" href="#_todomvc.views">todomvc.views</a></span>
  <span class="p">(</span><span class="ss">:require</span> <span class="p">[</span><span class="nv">reagent.core</span>  <span class="ss">:as</span> <span class="nv">reagent</span> <span class="ss">:refer</span> <span class="p">[</span><span class="nv"><a class="hidden" href="https://crossclj.info/ns/reagent/latest/reagent.core.cljs.html#_atom">atom</a></span><span class="p">]]</span>
            <span class="p">[</span><span class="nv">re-frame.core</span> <span class="ss">:refer</span> <span class="p">[</span><span class="nv"><a class="hidden" href="/pyccoon-cljs-re-frame/src/re_frame/core.cljs.html#_subscribe">subscribe</a></span> <span class="nv"><a class="hidden" href="/pyccoon-cljs-re-frame/src/re_frame/core.cljs.html#_dispatch">dispatch</a></span><span class="p">]]))</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-1" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-1'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <a id="_todo-input" class="section-anchor"></a><div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">todo-input</span> <span class="p">[{</span><span class="ss">:keys</span> <span class="p">[</span><span class="nv">title</span> <span class="nv">on-save</span> <span class="nv">on-stop</span><span class="p">]}]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nb">val </span><span class="p">(</span><span class="nf">atom</span> <span class="nv">title</span><span class="p">)</span>
        <span class="nv">stop</span> <span class="o">#</span><span class="p">(</span><span class="k">do </span><span class="p">(</span><span class="nf">reset!</span> <span class="nb">val </span><span class="s">&quot;&quot;</span><span class="p">)</span>
                  <span class="p">(</span><span class="k">if </span><span class="nv">on-stop</span> <span class="p">(</span><span class="nf">on-stop</span><span class="p">)))</span>
        <span class="nv">save</span> <span class="o">#</span><span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">v</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="o">@</span><span class="nb">val str </span><span class="nv">clojure.string/trim</span><span class="p">)]</span>
               <span class="p">(</span><span class="nb">if-not </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">v</span><span class="p">)</span> <span class="p">(</span><span class="nf">on-save</span> <span class="nv">v</span><span class="p">))</span>
               <span class="p">(</span><span class="nf">stop</span><span class="p">))]</span>
    <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">props</span><span class="p">]</span>
      <span class="p">[</span><span class="ss">:input</span> <span class="p">(</span><span class="nb">merge </span><span class="nv">props</span>
                     <span class="p">{</span><span class="ss">:type</span> <span class="s">&quot;text&quot;</span>
                      <span class="ss">:value</span> <span class="o">@</span><span class="nv">val</span>
                      <span class="ss">:on-blur</span> <span class="nv">save</span>
                      <span class="ss">:on-change</span> <span class="o">#</span><span class="p">(</span><span class="nf">reset!</span> <span class="nb">val </span><span class="p">(</span><span class="nb">-&gt; </span><span class="nv">%</span> <span class="nv">.-target</span> <span class="nv">.-value</span><span class="p">))</span>
                      <span class="ss">:on-key-down</span> <span class="o">#</span><span class="p">(</span><span class="nf">case</span> <span class="p">(</span><span class="nf">.-which</span> <span class="nv">%</span><span class="p">)</span>
                                     <span class="mi">13</span> <span class="p">(</span><span class="nf">save</span><span class="p">)</span>
                                     <span class="mi">27</span> <span class="p">(</span><span class="nf">stop</span><span class="p">)</span>
                                     <span class="nv">nil</span><span class="p">)})])))</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-2" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-2'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <a id="_todo-edit" class="section-anchor"></a><div class="highlight"><pre><span class="p">(</span><span class="k">def </span><span class="nv"><a class="hidden" href="#_todo-edit">todo-edit</a></span> <span class="p">(</span><span class="nb">with-meta </span><span class="nv"><a class="hidden" href="#_todo-input">todo-input</a></span>
                          <span class="p">{</span><span class="ss">:component-did-mount</span> <span class="o">#</span><span class="p">(</span><span class="nf">.focus</span> <span class="p">(</span><span class="nf"><a class="hidden" href="https://crossclj.info/ns/reagent/latest/reagent.core.cljs.html#_dom-node">reagent/dom-node</a></span> <span class="nv">%</span><span class="p">))}))</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-3" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-3'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <a id="_stats-footer" class="section-anchor"></a><div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv"><a class="hidden" href="#_stats-footer">stats-footer</a></span>
  <span class="p">[]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">footer-stats</span> <span class="p">(</span><span class="nf"><a class="hidden" href="/pyccoon-cljs-re-frame/src/re_frame/core.cljs.html#_subscribe">subscribe</a></span> <span class="p">[</span><span class="ss">:footer-stats</span><span class="p">])]</span>
    <span class="p">(</span><span class="k">fn </span><span class="p">[]</span>
      <span class="p">(</span><span class="k">let </span><span class="p">[[</span><span class="nv">active</span> <span class="nv">done</span> <span class="nv">filter</span><span class="p">]</span> <span class="o">@</span><span class="nv">footer-stats</span>
            <span class="nv">props-for</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">filter-kw</span> <span class="nv">txt</span><span class="p">]</span>
                        <span class="p">[</span><span class="ss">:a</span> <span class="p">{</span><span class="ss">:class</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">filter-kw</span> <span class="nv">filter</span><span class="p">)</span> <span class="s">"selected"</span><span class="p">)</span>
                             <span class="ss">:href</span> <span class="p">(</span><span class="nb">str </span><span class="s">"#/"</span> <span class="p">(</span><span class="nb">name </span><span class="nv">filter-kw</span><span class="p">))}</span> <span class="nv">txt</span><span class="p">])]</span>
        <span class="p">[</span><span class="ss">:footer#footer</span>
         <span class="p">[</span><span class="ss">:div</span>
          <span class="p">[</span><span class="ss">:span#todo-count</span>
           <span class="p">[</span><span class="ss">:strong</span> <span class="nv">active</span><span class="p">]</span> <span class="s">" "</span> <span class="p">(</span><span class="nf">case</span> <span class="nv">active</span> <span class="mi">1</span> <span class="s">"item"</span> <span class="s">"items"</span><span class="p">)</span> <span class="s">" left"</span><span class="p">]</span>
          <span class="p">[</span><span class="ss">:ul#filters</span>
           <span class="p">[</span><span class="ss">:li</span> <span class="p">(</span><span class="nf">props-for</span> <span class="ss">:all</span> <span class="s">"All"</span><span class="p">)]</span>
           <span class="p">[</span><span class="ss">:li</span> <span class="p">(</span><span class="nf">props-for</span> <span class="ss">:active</span> <span class="s">"Active"</span><span class="p">)]</span>
           <span class="p">[</span><span class="ss">:li</span> <span class="p">(</span><span class="nf">props-for</span> <span class="ss">:done</span> <span class="s">"Completed"</span><span class="p">)]]</span>
          <span class="p">(</span><span class="nb">when </span><span class="p">(</span><span class="nb">pos? </span><span class="nv">done</span><span class="p">)</span>
            <span class="p">[</span><span class="ss">:button#clear-completed</span> <span class="p">{</span><span class="ss">:on-click</span> <span class="o">#</span><span class="p">(</span><span class="nf"><a class="hidden" href="/pyccoon-cljs-re-frame/src/re_frame/core.cljs.html#_dispatch">dispatch</a></span> <span class="p">[</span><span class="ss">:clear-completed</span><span class="p">])}</span>
             <span class="s">"Clear completed "</span> <span class="nv">done</span><span class="p">])]]))))</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-4" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-4'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <a id="_todo-item" class="section-anchor"></a><div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv"><a class="hidden" href="#_todo-item">todo-item</a></span>
  <span class="p">[]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">editing</span> <span class="p">(</span><span class="nf"><a class="hidden" href="https://crossclj.info/ns/reagent/latest/reagent.core.cljs.html#_atom">atom</a></span> <span class="nv">false</span><span class="p">)]</span>
    <span class="p">(</span><span class="k">fn </span><span class="p">[{</span><span class="ss">:keys</span> <span class="p">[</span><span class="nv">id</span> <span class="nv">done</span> <span class="nv">title</span><span class="p">]}]</span>
      <span class="p">[</span><span class="ss">:li</span> <span class="p">{</span><span class="ss">:class</span> <span class="p">(</span><span class="nb">str </span><span class="p">(</span><span class="k">if </span><span class="nv">done</span> <span class="s">"completed "</span><span class="p">)</span>
                        <span class="p">(</span><span class="k">if </span><span class="o">@</span><span class="nv">editing</span> <span class="s">"editing"</span><span class="p">))}</span>
       <span class="p">[</span><span class="ss">:div.view</span>
        <span class="p">[</span><span class="ss">:input.toggle</span> <span class="p">{</span><span class="ss">:type</span> <span class="s">"checkbox"</span>
                        <span class="ss">:checked</span> <span class="nv">done</span>
                        <span class="ss">:on-change</span> <span class="o">#</span><span class="p">(</span><span class="nf"><a class="hidden" href="/pyccoon-cljs-re-frame/src/re_frame/core.cljs.html#_dispatch">dispatch</a></span> <span class="p">[</span><span class="ss">:toggle-done</span> <span class="nv">id</span><span class="p">])}]</span>
        <span class="p">[</span><span class="ss">:label</span> <span class="p">{</span><span class="ss">:on-double-click</span> <span class="o">#</span><span class="p">(</span><span class="nf">reset!</span> <span class="nv">editing</span> <span class="nv">true</span><span class="p">)}</span> <span class="nv">title</span><span class="p">]</span>
        <span class="p">[</span><span class="ss">:button.destroy</span> <span class="p">{</span><span class="ss">:on-click</span> <span class="o">#</span><span class="p">(</span><span class="nf"><a class="hidden" href="/pyccoon-cljs-re-frame/src/re_frame/core.cljs.html#_dispatch">dispatch</a></span> <span class="p">[</span><span class="ss">:delete-todo</span> <span class="nv">id</span><span class="p">])}]]</span>
       <span class="p">(</span><span class="nb">when </span><span class="o">@</span><span class="nv">editing</span>
         <span class="p">[</span><span class="nv"><a class="hidden" href="#_todo-edit">todo-edit</a></span> <span class="p">{</span><span class="ss">:class</span> <span class="s">"edit"</span>
                     <span class="ss">:title</span> <span class="nv">title</span>
                     <span class="ss">:on-save</span> <span class="o">#</span><span class="p">(</span><span class="nf"><a class="hidden" href="/pyccoon-cljs-re-frame/src/re_frame/core.cljs.html#_dispatch">dispatch</a></span> <span class="p">[</span><span class="ss">:save</span> <span class="nv">id</span> <span class="nv">%</span><span class="p">])</span>
                     <span class="ss">:on-stop</span> <span class="o">#</span><span class="p">(</span><span class="nf">reset!</span> <span class="nv">editing</span> <span class="nv">false</span><span class="p">)}])])))</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-5" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-5'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <a id="_todo-list" class="section-anchor"></a><div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv"><a class="hidden" href="#_todo-list">todo-list</a></span>
  <span class="p">[</span><span class="nv">visible-todos</span><span class="p">]</span>
  <span class="p">[</span><span class="ss">:ul#todo-list</span>
   <span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">todo</span>  <span class="o">@</span><span class="nv">visible-todos</span><span class="p">]</span>
     <span class="o">^</span><span class="p">{</span><span class="ss">:key</span> <span class="p">(</span><span class="ss">:id</span> <span class="nv">todo</span><span class="p">)}</span> <span class="p">[</span><span class="nv"><a class="hidden" href="#_todo-item">todo-item</a></span> <span class="nv">todo</span><span class="p">])])</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-6" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-6'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <a id="_todo-app" class="section-anchor"></a><div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv"><a class="hidden" href="#_todo-app">todo-app</a></span>
  <span class="p">[]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">todos</span>           <span class="p">(</span><span class="nf"><a class="hidden" href="/pyccoon-cljs-re-frame/src/re_frame/core.cljs.html#_subscribe">subscribe</a></span> <span class="p">[</span><span class="ss">:todos</span><span class="p">])</span>
        <span class="nv">visible-todos</span>   <span class="p">(</span><span class="nf"><a class="hidden" href="/pyccoon-cljs-re-frame/src/re_frame/core.cljs.html#_subscribe">subscribe</a></span> <span class="p">[</span><span class="ss">:visible-todos</span><span class="p">])</span>
        <span class="nv">completed-count</span> <span class="p">(</span><span class="nf"><a class="hidden" href="/pyccoon-cljs-re-frame/src/re_frame/core.cljs.html#_subscribe">subscribe</a></span> <span class="p">[</span><span class="ss">:completed-count</span><span class="p">])]</span>
    <span class="p">(</span><span class="k">fn </span><span class="p">[]</span>
      <span class="p">[</span><span class="ss">:div</span>
       <span class="p">[</span><span class="ss">:section#todoapp</span>
        <span class="p">[</span><span class="ss">:header#header</span>
         <span class="p">[</span><span class="ss">:h1</span> <span class="s">"todos"</span><span class="p">]</span>
         <span class="p">[</span><span class="nv"><a class="hidden" href="#_todo-input">todo-input</a></span> <span class="p">{</span><span class="ss">:id</span> <span class="s">"new-todo"</span>
                      <span class="ss">:placeholder</span> <span class="s">"What needs to be done?"</span>
                      <span class="ss">:on-save</span> <span class="o">#</span><span class="p">(</span><span class="nf"><a class="hidden" href="/pyccoon-cljs-re-frame/src/re_frame/core.cljs.html#_dispatch">dispatch</a></span> <span class="p">[</span><span class="ss">:add-todo</span> <span class="nv">%</span><span class="p">])}]]</span>
        <span class="p">(</span><span class="nb">when-not </span><span class="p">(</span><span class="nf">empty?</span> <span class="o">@</span><span class="nv">todos</span><span class="p">)</span>
          <span class="p">[</span><span class="ss">:div</span>
           <span class="p">[</span><span class="ss">:section#main</span>
            <span class="p">[</span><span class="ss">:input#toggle-all</span>
             <span class="p">{</span><span class="ss">:type</span> <span class="s">"checkbox"</span>
              <span class="ss">:checked</span> <span class="p">(</span><span class="nb">pos? </span><span class="o">@</span><span class="nv">completed-count</span><span class="p">)</span>
              <span class="ss">:on-change</span> <span class="o">#</span><span class="p">(</span><span class="nf"><a class="hidden" href="/pyccoon-cljs-re-frame/src/re_frame/core.cljs.html#_dispatch">dispatch</a></span> <span class="p">[</span><span class="ss">:complete-all-toggle</span><span class="p">])}]</span>
            <span class="p">[</span><span class="ss">:label</span> <span class="p">{</span><span class="ss">:for</span> <span class="s">"toggle-all"</span><span class="p">}</span> <span class="s">"Mark all as complete"</span><span class="p">]</span>
            <span class="p">[</span><span class="nv"><a class="hidden" href="#_todo-list">todo-list</a></span> <span class="nv">visible-todos</span><span class="p">]]</span>
           <span class="p">[</span><span class="nv"><a class="hidden" href="#_stats-footer">stats-footer</a></span><span class="p">]])]</span>
       <span class="p">[</span><span class="ss">:footer#info</span>
        <span class="p">[</span><span class="ss">:p</span> <span class="s">"Double-click to edit a todo"</span><span class="p">]]])))</span>

</pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-endpage" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-'>#</a>
          </div>
          <p>
            <div class="endpage"></div>
          </p>
        </div>
        <div class='code'>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
  </div>
</body>
